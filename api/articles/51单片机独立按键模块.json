{"title":"51单片机独立按键模块","uid":"b47f8004de5de2e7f095c07f5432799b","slug":"51单片机独立按键模块","date":"2024-02-02T14:37:25.000Z","updated":"2024-02-02T16:06:53.947Z","comments":true,"path":"api/articles/51单片机独立按键模块.json","keywords":null,"cover":[],"content":"<h1 id=\"51单片机的独立按键模块\"><a href=\"#51单片机的独立按键模块\" class=\"headerlink\" title=\"51单片机的独立按键模块\"></a>51单片机的独立按键模块</h1><p>这篇文章我们来学习51单片机开发板的独立按键模块</p>\n<p>根据开发板原理图，独立按键模块的接口如下图所示</p>\n<img src=\"/post/51%E5%8D%95%E7%89%87%E6%9C%BA%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE%E6%A8%A1%E5%9D%97/image2.png\" alt=\"image-20240202224538215\" style=\"zoom: 67%;\">\n\n<p>如图所示，四个独立按键都是检测低电平，且<strong>K1由P3_1控制，K2由P3_0控制</strong>，K3、K4由P3_2、P3_3控制</p>\n<h2 id=\"按键的抖动\"><a href=\"#按键的抖动\" class=\"headerlink\" title=\"按键的抖动\"></a>按键的抖动</h2><p>对于机械开关，机械触点断开闭合时，由于机械开关触点的弹性作用，一个开关在闭合的时候不会马上稳定的接通，在断开的时候也不会一下子就断开，在闭合和断开的那一瞬间会伴随一连串的抖动</p>\n<img src=\"/post/51%E5%8D%95%E7%89%87%E6%9C%BA%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE%E6%A8%A1%E5%9D%97/image1.png\" alt=\"image-20240202233542017\" style=\"zoom:67%;\">\n\n<p>对于按键抖动，一般有两种方法可以消除，一种是<strong>硬件消抖</strong>，通过按键输出通道上添加去抖动电路（如单稳态电路或者滤波电路等（详情见模拟电路））从根本上避免抖动发生，但是由于增加了硬件电路，会增加一定的成本和电路的复杂程度。还有一种最常用的消抖方法是<strong>软件消抖</strong>，在检测到按键按下时，延迟一定的时间（5-10毫秒甚至20毫秒）等抖动期过去后重新检测按键的状态，如果在延迟期间按键保持闭合状态，则认为是有效的按键按下，如果不是，则有可能是一个抖动的干扰信号，按键的释放过程也类似，检测到按键松开时，延迟一定时间（5-10毫秒）等抖动期过去后结束。</p>\n<div class=\"language-c\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">c</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #292D3E\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #C792EA\">void</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">main</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #676E95; font-style: italic\">  //这里我们只给出主函数，延时函数等模块的代码自行添加</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF; font-style: italic\">while</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F07178\">P3_1</span><span style=\"color: #89DDFF\">==</span><span style=\"color: #F78C6C\">0</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #676E95; font-style: italic\">//判断K1按下</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">            </span><span style=\"color: #82AAFF\">Delay</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">20</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #676E95; font-style: italic\">//延时20ms过滤掉抖动</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">            </span><span style=\"color: #89DDFF; font-style: italic\">while</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F07178\">P3_1</span><span style=\"color: #89DDFF\">==</span><span style=\"color: #F78C6C\">0</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #676E95; font-style: italic\">//如果按键一直按下，会在这个循环里一直循环，松手后会跳出循环</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">            </span><span style=\"color: #82AAFF\">Delay</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">20</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #676E95; font-style: italic\">//过滤掉松手后的抖动</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span></span></code></pre></div><h2 id=\"独立按键使用示例\"><a href=\"#独立按键使用示例\" class=\"headerlink\" title=\"独立按键使用示例\"></a>独立按键使用示例</h2><p>独立按键其实是一个非常简单的模块，主要是在编写程序的时候会用到大量的IF语句，比较考验编程者的逻辑思维能力，下面给出一段调用独立按键模块的示例代码和注释，方便大家学习</p>\n<div class=\"language-c\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">c</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #292D3E\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">#include</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #C3E88D\">REGX52.H</span><span style=\"color: #89DDFF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #C792EA\">void</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">Delay</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #C792EA\">unsigned</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C792EA\">int</span><span style=\"color: #BABED8\"> </span><span style=\"color: #BABED8; font-style: italic\">xms</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #676E95; font-style: italic\"> //自定义延时函数</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #C792EA\">unsigned</span><span style=\"color: #F07178\"> </span><span style=\"color: #C792EA\">char</span><span style=\"color: #F07178\"> i</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #F07178\"> j</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF; font-style: italic\">while</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F07178\">xms</span><span style=\"color: #89DDFF\">--)</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        i </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F07178\"> </span><span style=\"color: #F78C6C\">2</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        j </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F07178\"> </span><span style=\"color: #F78C6C\">239</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #89DDFF; font-style: italic\">do</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">            </span><span style=\"color: #89DDFF; font-style: italic\">while</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF\">(--</span><span style=\"color: #F07178\">j</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #89DDFF\">&#125;</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF; font-style: italic\">while</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF\">(--</span><span style=\"color: #F07178\">i</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #C792EA\">void</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">main</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF; font-style: italic\">while</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F07178\">P3_1</span><span style=\"color: #89DDFF\">==</span><span style=\"color: #F78C6C\">0</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #676E95; font-style: italic\">//判断K1按下</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">            </span><span style=\"color: #82AAFF\">Delay</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">20</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #676E95; font-style: italic\">//延时20ms过滤掉抖动</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">            </span><span style=\"color: #89DDFF; font-style: italic\">while</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F07178\">P3_1</span><span style=\"color: #89DDFF\">==</span><span style=\"color: #F78C6C\">0</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #676E95; font-style: italic\">//如果按键一直按下，会在这个循环里一直循环，松手后会跳出循环</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">            </span><span style=\"color: #82AAFF\">Delay</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">20</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #676E95; font-style: italic\">//过滤掉松手后的抖动</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">             P2</span><span style=\"color: #89DDFF\">=~</span><span style=\"color: #F07178\">P2</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #676E95; font-style: italic\">//松手后LED模块会全部亮起或者全部熄灭</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span></span></code></pre></div>","feature":true,"text":"51单片机的独立按键模块这篇文章我们来学习51单片机开发板的独立按键模块 根据开发板原理图，独立按键模块的接口如下图所示 如图所示，四个独立按键都是检测低电平，...","permalink":"/post/51单片机独立按键模块","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"51单片机","slug":"51单片机","count":4,"path":"api/categories/51单片机.json"}],"tags":[{"name":"电子","slug":"电子","count":5,"path":"api/tags/电子.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#51%E5%8D%95%E7%89%87%E6%9C%BA%E7%9A%84%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE%E6%A8%A1%E5%9D%97\"><span class=\"toc-text\">51单片机的独立按键模块</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%8C%89%E9%94%AE%E7%9A%84%E6%8A%96%E5%8A%A8\"><span class=\"toc-text\">按键的抖动</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B\"><span class=\"toc-text\">独立按键使用示例</span></a></li></ol></li></ol>","author":{"name":"Ed-RYan","slug":"blog-author","avatar":"https://picdl.sunbangyan.cn/2024/01/27/b3236412f4a1762b08031ab7af587235.webp","link":"/","description":"想暂停时间 <br /> @ <b>淼</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"QQ":{"icon":"iconfont icon-tengxunQQ","link":"https://picdl.sunbangyan.cn/2024/01/21/8f2f70af10b4f0d5d6f32559116ba096.jpeg"},"Bilibili":{"icon":"iconfont icon-bilibili","link":"https://space.bilibili.com/142342578?spm_id_from=333.1007.0.0"},"Wechat":{"icon":"iconfont icon-weixin","link":"https://picdl.sunbangyan.cn/2024/01/21/42a74c77817f8c7588ebeedffd7e94e3.jpeg"},"WechatPay":{"icon":"iconfont icon-weixinzhifu","link":"https://picss.sunbangyan.cn/2024/01/21/42669be5c178707607662c75477734a8.jpeg"}}}},"mapped":true,"hidden":false,"prev_post":{},"next_post":{"title":"Java数据结构和算法","uid":"96563376ad7b138d66798614753928b1","slug":"Java数据结构和算法","date":"2024-01-24T12:30:11.000Z","updated":"2024-01-29T15:24:36.159Z","comments":true,"path":"api/articles/Java数据结构和算法.json","keywords":null,"cover":"https://picdl.sunbangyan.cn/2024/01/27/b9b0ad317c036651387fed265203b71c.webp","text":"Java 数据结构和算法数据结构和算法的重要性： 算法是程序的灵魂，程序在进行海量的数据计算时，优秀的算法可以让程序保持高速运算 程序会使用 内存计算框架 和 ...","permalink":"/post/Java数据结构和算法","photos":[],"count_time":{"symbolsCount":"18k","symbolsTime":"16 mins."},"categories":[{"name":"编程","slug":"编程","count":3,"path":"api/categories/编程.json"}],"tags":[{"name":"Java","slug":"Java","count":2,"path":"api/tags/Java.json"}],"author":{"name":"Ed-RYan","slug":"blog-author","avatar":"https://picdl.sunbangyan.cn/2024/01/27/b3236412f4a1762b08031ab7af587235.webp","link":"/","description":"想暂停时间 <br /> @ <b>淼</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"QQ":{"icon":"iconfont icon-tengxunQQ","link":"https://picdl.sunbangyan.cn/2024/01/21/8f2f70af10b4f0d5d6f32559116ba096.jpeg"},"Bilibili":{"icon":"iconfont icon-bilibili","link":"https://space.bilibili.com/142342578?spm_id_from=333.1007.0.0"},"Wechat":{"icon":"iconfont icon-weixin","link":"https://picdl.sunbangyan.cn/2024/01/21/42a74c77817f8c7588ebeedffd7e94e3.jpeg"},"WechatPay":{"icon":"iconfont icon-weixinzhifu","link":"https://picss.sunbangyan.cn/2024/01/21/42669be5c178707607662c75477734a8.jpeg"}}}},"feature":true}}