{"title":"51单片机常用模块驱动代码","uid":"0e7c93a805541486cdd5b2caca119a40","slug":"51单片机常用模块驱动代码","date":"2024-02-02T09:45:18.000Z","updated":"2024-02-02T16:43:54.451Z","comments":true,"path":"api/articles/51单片机常用模块驱动代码.json","keywords":null,"cover":"https://picst.sunbangyan.cn/2024/02/03/149c8bbbc5a01a7e56b0e0ab43324e25.webp","content":"<h1 id=\"51单片机常用模块驱动代码\"><a href=\"#51单片机常用模块驱动代码\" class=\"headerlink\" title=\"51单片机常用模块驱动代码\"></a>51单片机常用模块驱动代码</h1><h2 id=\"延时代码Delay\"><a href=\"#延时代码Delay\" class=\"headerlink\" title=\"延时代码Delay()\"></a>延时代码Delay()</h2><p>在STC-ISP中，我们可以根据自己开发板的型号和系统的频率来自动生成对应时间的延时代码，需要多长时间我们就选择对应的定时长度。</p>\n<img src=\"/post/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97%E9%A9%B1%E5%8A%A8%E4%BB%A3%E7%A0%81/image1.png\" alt=\"image-20240202183320412\" style=\"zoom:50%;\">\n\n<p>但是生成的延时代码只能对应一个延时时间，所以我们需要自己构造一个函数，来延时我们想要延时的时间，我们可观察到的时间单位一般是以秒或者毫秒为单位的，如果是以微秒为的单位，开发板的变化可能以肉眼观察不到，所以我们<strong>自动生成一个一毫秒的延时代码</strong>，将自动生成的代码复制到Keil中</p>\n<img src=\"/post/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97%E9%A9%B1%E5%8A%A8%E4%BB%A3%E7%A0%81/image2.png\" alt=\"image-20240202184003311\" style=\"zoom: 67%;\">\n\n<p>已知根据开发板的配置生成的一毫秒的延时函数，即一次这样的do-while循环会延时1毫秒，所以我们在里面构造一个while函数，定义一个xms形参，来定义我们想要延时的毫秒数，修改后的Delay函数如下</p>\n<div class=\"language-c\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">c</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #292D3E\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #C792EA\">void</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">Delay</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #C792EA\">unsigned</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C792EA\">char</span><span style=\"color: #BABED8\"> </span><span style=\"color: #BABED8; font-style: italic\">xms</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #C792EA\">unsigned</span><span style=\"color: #F07178\"> </span><span style=\"color: #C792EA\">char</span><span style=\"color: #F07178\"> i</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #F07178\"> j</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF; font-style: italic\">while</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F07178\">xms</span><span style=\"color: #89DDFF\">--)</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        i </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F07178\"> </span><span style=\"color: #F78C6C\">2</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        j </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F07178\"> </span><span style=\"color: #F78C6C\">239</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #89DDFF; font-style: italic\">do</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">            </span><span style=\"color: #89DDFF; font-style: italic\">while</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF\">(--</span><span style=\"color: #F07178\">j</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #89DDFF\">&#125;</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF; font-style: italic\">while</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF\">(--</span><span style=\"color: #F07178\">i</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span></span></code></pre></div><p>这样，在开发板程序中，一个Delay（xms）函数就相当于延时了xms毫秒</p>\n<p>下面是一个使用示例</p>\n<div class=\"language-c\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">c</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #292D3E\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">#include</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #C3E88D\">REGX52.H</span><span style=\"color: #89DDFF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #C792EA\">void</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">Delay</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #C792EA\">unsigned</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C792EA\">char</span><span style=\"color: #BABED8\"> </span><span style=\"color: #BABED8; font-style: italic\">xms</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #676E95; font-style: italic\">\t//@12.000MHz</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #C792EA\">unsigned</span><span style=\"color: #F07178\"> </span><span style=\"color: #C792EA\">char</span><span style=\"color: #F07178\"> i</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #F07178\"> j</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF; font-style: italic\">while</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F07178\">xms</span><span style=\"color: #89DDFF\">--)</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        i </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F07178\"> </span><span style=\"color: #F78C6C\">2</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        j </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F07178\"> </span><span style=\"color: #F78C6C\">239</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #89DDFF; font-style: italic\">do</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">            </span><span style=\"color: #89DDFF; font-style: italic\">while</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF\">(--</span><span style=\"color: #F07178\">j</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #89DDFF\">&#125;</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF; font-style: italic\">while</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF\">(--</span><span style=\"color: #F07178\">i</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #C792EA\">void</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">main</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF; font-style: italic\">while</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        P2_0</span><span style=\"color: #89DDFF\">=~</span><span style=\"color: #F07178\">P2_0</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">        </span><span style=\"color: #82AAFF\">Delay</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">500</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span></span></code></pre></div><p>这段代码的实现功能是让开发板上LED模块的D1灯以500ms的频率闪烁</p>\n","text":"51单片机常用模块驱动代码延时代码Delay()在STC-ISP中，我们可以根据自己开发板的型号和系统的频率来自动生成对应时间的延时代码，需要多长时间我们就选择...","permalink":"/post/51单片机常用模块驱动代码","photos":[],"count_time":{"symbolsCount":991,"symbolsTime":"1 mins."},"categories":[{"name":"51单片机","slug":"51单片机","count":6,"path":"api/categories/51单片机.json"}],"tags":[{"name":"电子","slug":"电子","count":7,"path":"api/tags/电子.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#51%E5%8D%95%E7%89%87%E6%9C%BA%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97%E9%A9%B1%E5%8A%A8%E4%BB%A3%E7%A0%81\"><span class=\"toc-text\">51单片机常用模块驱动代码</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%BB%B6%E6%97%B6%E4%BB%A3%E7%A0%81Delay\"><span class=\"toc-text\">延时代码Delay()</span></a></li></ol></li></ol>","author":{"name":"Ed-RYan","slug":"blog-author","avatar":"https://picdl.sunbangyan.cn/2024/01/27/b3236412f4a1762b08031ab7af587235.webp","link":"/","description":"想暂停时间 <br /> @ <b>淼</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"QQ":{"icon":"iconfont icon-tengxunQQ","link":"https://picdl.sunbangyan.cn/2024/01/21/8f2f70af10b4f0d5d6f32559116ba096.jpeg"},"Bilibili":{"icon":"iconfont icon-bilibili","link":"https://space.bilibili.com/142342578?spm_id_from=333.1007.0.0"},"Wechat":{"icon":"iconfont icon-weixin","link":"https://picdl.sunbangyan.cn/2024/01/21/42a74c77817f8c7588ebeedffd7e94e3.jpeg"},"WechatPay":{"icon":"iconfont icon-weixinzhifu","link":"https://picss.sunbangyan.cn/2024/01/21/42669be5c178707607662c75477734a8.jpeg"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"51单片机独立按键模块","uid":"b47f8004de5de2e7f095c07f5432799b","slug":"51单片机独立按键模块","date":"2024-02-02T14:37:25.000Z","updated":"2024-02-02T16:44:57.077Z","comments":true,"path":"api/articles/51单片机独立按键模块.json","keywords":null,"cover":"https://picdl.sunbangyan.cn/2024/02/03/6abdd41ba5d2dd68bd12c17db33a89d1.webp","text":"51 单片机的独立按键模块这篇文章我们来学习 51 单片机开发板的独立按键模块 根据开发板原理图，独立按键模块的接口如下图所示 如图所示，四个独立按键都是检测低...","permalink":"/post/51单片机独立按键模块","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"51单片机","slug":"51单片机","count":6,"path":"api/categories/51单片机.json"}],"tags":[{"name":"电子","slug":"电子","count":7,"path":"api/tags/电子.json"}],"author":{"name":"Ed-RYan","slug":"blog-author","avatar":"https://picdl.sunbangyan.cn/2024/01/27/b3236412f4a1762b08031ab7af587235.webp","link":"/","description":"想暂停时间 <br /> @ <b>淼</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"QQ":{"icon":"iconfont icon-tengxunQQ","link":"https://picdl.sunbangyan.cn/2024/01/21/8f2f70af10b4f0d5d6f32559116ba096.jpeg"},"Bilibili":{"icon":"iconfont icon-bilibili","link":"https://space.bilibili.com/142342578?spm_id_from=333.1007.0.0"},"Wechat":{"icon":"iconfont icon-weixin","link":"https://picdl.sunbangyan.cn/2024/01/21/42a74c77817f8c7588ebeedffd7e94e3.jpeg"},"WechatPay":{"icon":"iconfont icon-weixinzhifu","link":"https://picss.sunbangyan.cn/2024/01/21/42669be5c178707607662c75477734a8.jpeg"}}}},"feature":true},"next_post":{"title":"使用51单片机控制LED模块","uid":"455781cc215699651b5e7dac0955faf1","slug":"使用51单片机控制LED模块","date":"2024-02-02T09:37:36.000Z","updated":"2024-02-02T16:44:17.645Z","comments":true,"path":"api/articles/使用51单片机控制LED模块.json","keywords":null,"cover":"https://picdm.sunbangyan.cn/2024/02/03/eca10e2407e3b4fd6807a063275d3e87.webp","text":"用 51 单片机控制单片机上的 LEDLED 介绍： 中文名：发光二极管 英文名：Light Emitting Diode 简称 LED 用途：照明、广告灯、指...","permalink":"/post/使用51单片机控制LED模块","photos":[],"count_time":{"symbolsCount":"3.7k","symbolsTime":"3 mins."},"categories":[{"name":"51单片机","slug":"51单片机","count":6,"path":"api/categories/51单片机.json"}],"tags":[{"name":"电子","slug":"电子","count":7,"path":"api/tags/电子.json"}],"author":{"name":"Ed-RYan","slug":"blog-author","avatar":"https://picdl.sunbangyan.cn/2024/01/27/b3236412f4a1762b08031ab7af587235.webp","link":"/","description":"想暂停时间 <br /> @ <b>淼</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"QQ":{"icon":"iconfont icon-tengxunQQ","link":"https://picdl.sunbangyan.cn/2024/01/21/8f2f70af10b4f0d5d6f32559116ba096.jpeg"},"Bilibili":{"icon":"iconfont icon-bilibili","link":"https://space.bilibili.com/142342578?spm_id_from=333.1007.0.0"},"Wechat":{"icon":"iconfont icon-weixin","link":"https://picdl.sunbangyan.cn/2024/01/21/42a74c77817f8c7588ebeedffd7e94e3.jpeg"},"WechatPay":{"icon":"iconfont icon-weixinzhifu","link":"https://picss.sunbangyan.cn/2024/01/21/42669be5c178707607662c75477734a8.jpeg"}}}}}}